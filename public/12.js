(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{3:function(t,r,e){"use strict";var o={props:["path"]},s=e(1),a=Object(s.a)(o,(function(){var t=this.$createElement,r=this._self._c||t;return r("v-img",{attrs:{src:"https://drive.google.com/thumbnail?id="+this.path+"&sz=w800-h800","lazy-src":"https://drive.google.com/thumbnail?id="+this.path+"&sz=w800-h800"},scopedSlots:this._u([{key:"placeholder",fn:function(){return[r("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[r("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}])})}),[],!1,null,null,null);r.a=a.exports},53:function(t,r,e){"use strict";e.r(r);var o=e(0),s=e.n(o),a=e(2),n=e(3),c={props:["propProducts","propSum"],components:{imageThumbnailPathSize800:n.a},data:function(){return{}},methods:{clickRemoveProduct:function(t){this.propProducts.splice(this.propProducts.indexOf(t),1),this.propSum.price_normal=this.propSum.price_normal-parseFloat(t.price_normal),this.propSum.price_special=this.propSum.price_special-parseFloat(t.price_special),this.propSum.discount=this.propSum.price_special-this.propSum.price_normal}}},i=e(1),l=Object(i.a)(c,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",t._l(t.propProducts,(function(r){return e("v-card",{key:r.key,staticClass:"pa-0 mb-4"},[e("v-card-text",[e("v-row",[e("v-col",{staticClass:"pa-2",attrs:{cols:"4"}},[e("imageThumbnailPathSize800",{attrs:{path:r.image}})],1),t._v(" "),e("v-col",{staticClass:"pa-2",attrs:{cols:"8"}},[e("h5",{staticClass:"black--text mb-1"},[t._v(t._s(r.title))]),t._v(" "),e("p",{staticClass:"text-body-1 mb-0 font-weight-black deep-orange--text"},[t._v("\n            ฿"+t._s(r.price_special)+"\n          ")]),t._v(" "),e("p",{staticClass:"text-caption mb-1 text-decoration-line-through"},[t._v("\n            ฿"+t._s(r.price_normal)+"\n          ")]),t._v(" "),e("v-btn",{staticClass:"error",attrs:{"x-small":""},on:{click:function(e){return t.clickRemoveProduct(r)}}},[t._v("ลบ")])],1)],1)],1)],1)})),1)}),[],!1,null,null,null).exports,p=e(4);Vue.filter("formatNumber",(function(t){return p(t).format("0,0.00")}));var u={props:["propSum","propProducts"]},v=Object(i.a)(u,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",[e("v-card",{staticClass:"mb-4"},[e("v-card-title",[e("h4",{staticClass:"mb-0"},[t._v("สรุปยอดทั้งหมด")])]),t._v(" "),e("v-card-text",[e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("รวมค่าสินค้า")]),t._v(" ("+t._s(t.propProducts.length)+"\n          ชิ้น)")]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6 "}},[e("strong",[t._v("฿"+t._s(t._f("formatNumber")(parseFloat(t.propSum.price_normal))))])])],1),t._v(" "),e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("ส่วนลด")])]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6"}},[e("strong",{staticClass:"red--text"},[t._v("฿"+t._s(t._f("formatNumber")(parseFloat(t.propSum.discount))))])])],1),t._v(" "),e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("ยอดรวมทั้งหมด")])]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6"}},[e("strong",[t._v("฿"+t._s(t._f("formatNumber")(parseFloat(t.propSum.price_special))))])])],1)],1)],1)],1)}),[],!1,null,null,null).exports,m=e(4);Vue.filter("formatNumber",(function(t){return m(t).format("0,0.00")}));var _={props:["propSum","propProducts"],data:function(){return{getFree:0,getMore:0,buyGet:0}},methods:{},computed:{discount:function(){var t=this.propProducts;this.buyGet=2;for(var r=[],e=0;e<t.length;e++)r.push(parseFloat(t[e].price_special));this.getMore=2-2*(r.length/2-parseInt(r.length/2));var o=r.sort((function(t,r){return t-r})),s=1*parseInt(o.length/2);this.getFree=s;var a=o.slice(0,s).reduce((function(t,r){return t+r}),0);return parseFloat(a)},sumUp:function(){return parseFloat(this.propSum.price_special)-this.discount}}},d=Object(i.a)(_,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",[t.getMore!=t.buyGet?e("v-alert",{attrs:{type:"info"}},[t._v("\n    เลือกเพิ่ม "+t._s(t.getMore)+" ชิ้น เพื่อรับสิทธิ์ตามโปรโมชั่น\n  ")]):t._e(),t._v(" "),e("v-card",{staticClass:"mb-4"},[e("v-card-title",[e("h4",{staticClass:"mb-0"},[t._v("สรุปยอดทั้งหมด")])]),t._v(" "),e("v-card-text",[e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("รวมค่าสินค้า")]),t._v(" ("+t._s(t.propProducts.length)+"\n          ชิ้น)")]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6 "}},[e("strong",[t._v("฿"+t._s(t._f("formatNumber")(parseFloat(t.propSum.price_special))))])])],1),t._v(" "),e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("ส่วนลด")]),t._v(" (ฟรี "+t._s(t.getFree)+" ชิ้น)\n        ")]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6"}},[e("strong",{staticClass:"red--text"},[t._v("฿"+t._s(t._f("formatNumber")(t.discount)))])])],1),t._v(" "),e("v-row",[e("v-col",{staticClass:"py-1",attrs:{cols:"6"}},[e("strong",[t._v("ยอดรวมทั้งหมด")])]),t._v(" "),e("v-col",{staticClass:"text-right py-1",attrs:{cols:"6"}},[e("strong",[t._v("฿"+t._s(t._f("formatNumber")(t.sumUp)))])])],1)],1)],1)],1)}),[],!1,null,null,null).exports,h={props:["propCustomer"],data:function(){return{rules:{name:[function(t){return!!t||"ห้ามเว้นว่าง"}],phone_number:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 10==t.length||"กรอกเบอร์โทร 10 หลักเท่านั้น"},function(t){return/[0]{1}[0-9]{9}/.test(t)||"กรุณาขึ้นต้นด้วยเลข 0 และกรอกเบอร์โทร 10 หลักเท่านั้น"}]}}}};function f(t,r,e,o,s,a,n){try{var c=t[a](n),i=c.value}catch(t){return void e(t)}c.done?r(i):Promise.resolve(i).then(o,s)}var g={components:{cardProducts:l,sumPrice:v,cardCustomer:Object(i.a)(h,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",[e("v-card",{staticClass:"mb-4"},[e("v-card-title",[e("h4",{staticClass:"mb-0"},[t._v("ข้อมูลผู้สั่งซื้อ")])]),t._v(" "),e("v-card-text",{staticClass:"pb-0"},[e("v-text-field",{attrs:{label:"ชื่อลูกค้า",outlined:"",rules:t.rules.name},model:{value:t.propCustomer.name,callback:function(r){t.$set(t.propCustomer,"name",r)},expression:"propCustomer.name"}}),t._v(" "),e("v-text-field",{attrs:{label:"เบอร์โทรศัพท์",outlined:"",rules:t.rules.phone_number,pattern:"\\d*"},model:{value:t.propCustomer.phone_number,callback:function(r){t.$set(t.propCustomer,"phone_number",r)},expression:"propCustomer.phone_number"}})],1)],1)],1)}),[],!1,null,null,null).exports,sumPriceFreeCount:d},props:["propProducts","propSum","propPromotionID"],data:function(){return{dialog:!1,customer:{name:"",phone_number:""}}},methods:{save:function(){var t,r=this;return(t=s.a.mark((function t(){var e,o,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r.propProducts.length<=0)){t.next=3;break}return r.$swal({title:"โปรดเลือกสินค้าอย่างน้อย 1 รายการ",icon:"warning",confirmButtonText:"รับทราบ",allowOutsideClick:!1}),t.abrupt("return");case 3:if(!r.$refs.formCustomer.validate()){t.next=10;break}return e=r.$loading.show(),o={customer:r.customer,products:r.propProducts,sum:r.propSum,promotion_id:r.propPromotionID},t.next=8,r.$store.dispatch("order/store",o);case 8:200===(a=t.sent).status?(r.$swal({icon:"success",title:a.data.msgTitle,text:a.data.msgText,allowOutsideClick:!1,confirmButtonText:"รับทราบ",confirmButtonColor:"#3085d6"}).then((function(t){t.isConfirmed&&r.$router.replace("/order/"+a.data.uuid)})),e.hide()):201===a.status&&(e.hide(),r.$swal({icon:"warning",title:a.data.msgTitle,text:a.data.msgText,allowOutsideClick:!1,confirmButtonText:"รับทราบ",confirmButtonColor:"#3085d6"}).then((function(t){t.isConfirmed&&r.$router.replace("/promotions")})));case 10:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(o,s){var a=t.apply(r,e);function n(t){f(a,o,s,n,c,"next",t)}function c(t){f(a,o,s,n,c,"throw",t)}n(void 0)}))})()}}},b=Object(i.a)(g,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",[e("v-dialog",{attrs:{fullscreen:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on;return[e("v-bottom-navigation",{staticClass:"yellow darken-4",attrs:{app:"",grow:""}},[e("v-btn",t._g({attrs:{block:"",disabled:t.propProducts.length<=0}},o),[e("span",{staticClass:"white--text"},[t._v(" ตะกร้าสินค้า ")]),t._v(" "),e("v-badge",{attrs:{content:t.propProducts.length,value:t.propProducts.length,color:"success"}},[e("v-icon",{staticClass:"white--text"},[t._v("shopping_cart")])],1)],1)],1)]}}]),model:{value:t.dialog,callback:function(r){t.dialog=r},expression:"dialog"}},[t._v(" "),e("v-card",[e("v-card-title",[e("h3",{staticClass:"mb-0"},[t._v("ตะกร้าสินค้า")]),t._v(" "),e("v-spacer"),t._v(" "),e("v-btn",{staticClass:"error",attrs:{fab:"","x-small":""},on:{click:function(r){t.dialog=!1}}},[e("v-icon",[t._v("close")])],1)],1),t._v(" "),e("v-card-text",{staticClass:"pa-2"},[e("cardProducts",{attrs:{propProducts:t.propProducts,propSum:t.propSum}}),t._v(" "),e("sumPrice",{attrs:{propSum:t.propSum,propProducts:t.propProducts}}),t._v(" "),e("v-form",{ref:"formCustomer",attrs:{"lazy-validation":""}},[e("cardCustomer",{attrs:{propCustomer:t.customer}})],1),t._v(" "),e("v-btn",{staticClass:"success mb-4",attrs:{"x-large":"",block:""},on:{click:function(r){return t.save()}}},[t._v("สั่งสินค้า")]),t._v(" "),e("v-btn",{staticClass:"error",attrs:{"x-large":"",block:""},on:{click:function(r){t.dialog=!1}}},[t._v("ออก")])],1)],1)],1)],1)}),[],!1,null,null,null).exports;function C(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,o)}return e}function x(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function P(t,r,e,o,s,a,n){try{var c=t[a](n),i=c.value}catch(t){return void e(t)}c.done?r(i):Promise.resolve(i).then(o,s)}var w={components:{imageThumbnailPathSize800:n.a,shoppingCart:b},data:function(){return{products_shopping_cart:[],promotion_id:"",sum:{price_normal:0,price_special:0,discount:0}}},methods:{clickAddToShoppingCart:function(t){this.products_shopping_cart.push(t),this.sum.price_normal=this.sum.price_normal+parseFloat(t.price_normal),this.sum.price_special=this.sum.price_special+parseFloat(t.price_special),this.sum.discount=this.sum.price_special-this.sum.price_normal}},mounted:function(){var t,r=this;return(t=s.a.mark((function t(){var e,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.$loading.show(),t.next=3,r.$store.dispatch("product/fetchByPromotionID",r.$route.params.promotion_id);case 3:201===(o=t.sent).status&&r.$swal({title:o.data.msgTitle,text:o.data.msgText,confirmButtonText:"รับทราบ"}),r.promotion_id=r.$route.params.promotion_id,e.hide();case 7:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(o,s){var a=t.apply(r,e);function n(t){P(a,o,s,n,c,"next",t)}function c(t){P(a,o,s,n,c,"throw",t)}n(void 0)}))})()},computed:function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?C(Object(e),!0).forEach((function(r){x(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):C(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}({},Object(a.b)({fetchPromotion:"product/fetchByPromotionID"}))},y=Object(i.a)(w,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return t.fetchPromotion?e("div",[e("v-card",{staticClass:"mb-4"},[e("v-card-title",[e("h3",[t._v("โปรโมชั่น : "+t._s(t.fetchPromotion.title))])]),t._v(" "),e("v-card-text",[e("v-row",[e("v-col",{attrs:{cols:"6"}},[t._v("สั่งซื้อได้ตั้งแต่")]),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"6"}},[t._v("\n          "+t._s(t.fetchPromotion.date_start)+"\n        ")])],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"6"}},[t._v("หมดเขตสั่งซื้อ/ชำระเงิน")]),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"6"}},[t._v("\n          "+t._s(t.fetchPromotion.date_end)+"\n        ")])],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"6"}},[t._v("วันที่รับสินค้า")]),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"6"}},[t._v("\n          "+t._s(t.fetchPromotion.date_get)+"\n        ")])],1)],1)],1),t._v(" "),t._l(t.fetchPromotion.use_promotion_products,(function(r){return e("v-card",{key:r.id,staticClass:"mb-4"},[e("imageThumbnailPathSize800",{attrs:{path:r.image}}),t._v(" "),e("v-card-title",[e("h4",[t._v("\n        "+t._s(r.title)+"\n      ")])]),t._v(" "),e("v-card-text",[e("v-row",[e("v-col",{attrs:{cols:"6"}},[t._v(" ราคาปกติ ")]),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"6"}},[t._v(t._s(r.price_normal))])],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"6"}},[t._v(" ราคาพิเศษ ")]),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"6"}},[t._v(t._s(r.price_special))])],1)],1),t._v(" "),e("v-card-actions",[e("v-btn",{staticClass:"success",attrs:{"x-large":"",block:""},on:{click:function(e){return t.clickAddToShoppingCart(r)}}},[t._v("\n        เพิ่มลงตะกร้า\n      ")])],1)],1)})),t._v(" "),e("shoppingCart",{attrs:{propPromotionID:t.promotion_id,propProducts:t.products_shopping_cart,propSum:t.sum}})],2):t._e()}),[],!1,null,null,null);r.default=y.exports}}]);