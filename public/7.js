(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{41:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r);function s(e,t,a,r,n,s,o){try{var c=e[s](o),i=c.value}catch(e){return void a(e)}c.done?t(i):Promise.resolve(i).then(r,n)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function c(e){s(o,r,n,c,i,"next",e)}function i(e){s(o,r,n,c,i,"throw",e)}c(void 0)}))}}var c={data:function(){return{response:{data:{success:!0}},chooseRemove:!1,previewExample:"",previewImages:[],form:{write:""},chooseRemoveImages:[]}},methods:{start:function(){var e=this;return o(n.a.mark((function t(){var a,r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.token=e.$route.params.token,t.next=3,axios.get("/api/v1/guest/order/"+e.token+"/uploadImageByToken");case 3:a=t.sent,r=a.data,e.response=r,e.form.write=r.data.order_detail.write;case 7:case"end":return t.stop()}}),t)})))()},onFileChangeExample:function(e){var t=this;return o(n.a.mark((function e(){var a,r,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.$loading.show(),r=event.target.files[0],(s=new FormData).append("image",r),e.next=6,axios.post("/api/v1/guest/order/"+t.token+"/uploadImageByToken/example",s);case 6:return o=e.sent,e.next=9,t.start();case 9:a.hide(),t.toast(o);case 11:case"end":return e.stop()}}),e)})))()},onFileChangeImages:function(e){var t=this;return o(n.a.mark((function a(){var r,s,o,c,i;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=t.$loading.show(),s=event.target.files,o=new FormData,t.$toast.warning("กำลังอัปโหลดรูป "+e.length+" รูป"),c={},i=0;case 6:if(!(i<e.length)){a.next=15;break}return o.append("image",s[i]),a.next=10,axios.post("/api/v1/guest/order/"+t.token+"/uploadImageByToken/images",o);case 10:(c=a.sent).data.success?t.$toast.success(c.data.message+" "+(i+1)+"/"+e.length+" รูป"):(i=e.length,t.$toast.error("คุณไม่มีสิทธิ์อัปโหลดส่วนนี้"));case 12:i++,a.next=6;break;case 15:return a.next=17,t.start();case 17:r.hide();case 18:case"end":return a.stop()}}),a)})))()},clickRemoveImage:function(e){var t=this;return o(n.a.mark((function a(){var r,s,o;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=t.$loading.show(),s={},t.$toast.warning("กำลังลบรูปภาพ "+e.length+" รูป"),o=0;case 4:if(!(o<e.length)){a.next=12;break}return a.next=7,axios.delete("/api/v1/guest/order/"+t.token+"/uploadImageByToken/"+e[o].id+"/delete");case 7:(s=a.sent).data.success?t.$toast.success(s.data.message+" "+(o+1)+"/"+e.length+" รูป"):(o=e.length,t.$toast.error("คุณไม่มีสิทธิ์อัปโหลดส่วนนี้"));case 9:o++,a.next=4;break;case 12:return t.clickRemoveImageCancel(),a.next=15,t.start();case 15:r.hide();case 16:case"end":return a.stop()}}),a)})))()},clickImageMain:function(e){var t=this;return o(n.a.mark((function a(){var r,s;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.$loading.show(),a.next=3,axios.post("/api/v1/guest/order/"+t.token+"/uploadImageByToken/"+e+"/ImageMain");case 3:return s=a.sent,a.next=6,t.start();case 6:r.hide(),t.toast(s);case 8:case"end":return a.stop()}}),a)})))()},clickSubmitUpdateWrite:function(){var e=this;return o(n.a.mark((function t(){var a,r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading.show(),t.next=3,axios.post("/api/v1/guest/order/"+e.token+"/updateWrite",e.form);case 3:return r=t.sent,t.next=6,e.start();case 6:a.hide(),e.toast(r);case 8:case"end":return t.stop()}}),t)})))()},toast:function(e){200===e.status?e.data.success?this.$toast.success(e.data.message):this.$toast.error(e.data.message):this.$toast.error("เกิดข้อผิดพลาดบางอย่างขึ้น กรุณาลองอีกครั้ง")},clickRemoveImageCancel:function(){this.chooseRemove=!1,this.chooseRemoveImages=[]}},mounted:function(){var e=this;return o(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$loading.show(),t.next=3,e.start();case 3:a.hide();case 4:case"end":return t.stop()}}),t)})))()}},i=a(1),l=Object(i.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.response.success?a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-card",[a("v-card-title",[e._v("รูปภาพต้นแบบสินค้า")]),e._v(" "),e.response.data.example?a("v-card-text",[e.response.data.example_image?a("v-img",{staticClass:"mb-4",attrs:{src:e.response.data.example_image.url}},[a("v-btn",{staticClass:"mt-4 ml-4",attrs:{color:"error"},on:{click:function(t){return e.clickRemoveImage([e.response.data.example_image])}}},[a("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("\n                            ลบรูปนี้\n                        ")],1)],1):a("div",[a("v-file-input",{staticClass:"mb-4",attrs:{outlined:"","prepend-icon":"image",placeholder:"รูปภาพต้นแบบสินค้า",accept:"image/*","hide-details":"",rules:[function(e){return!!e}]},on:{change:e.onFileChangeExample}}),e._v(" "),a("v-alert",{attrs:{type:"info"}},[e._v("โปรดอัปโหลดรูป")])],1)],1):a("v-card-text",[a("v-alert",{attrs:{type:"warning"}},[e._v("คุณไม่มีสิทธิ์อัปโหลดส่วนนี้")])],1)],1)],1),e._v(" "),a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-card",[a("v-card-title",[e._v("รูปภาพสำหรับทำสินค้า")]),e._v(" "),e.response.data.image?a("v-card-text",[a("v-text-field",{attrs:{label:"เขียนข้อความ",outlined:"","hide-details":"","prepend-icon":"edit"},model:{value:e.form.write,callback:function(t){e.$set(e.form,"write",t)},expression:"form.write"}}),e._v(" "),a("v-btn",{staticClass:"mt-2",attrs:{large:"",color:"success",block:"",disabled:e.form.write==e.response.data.order_detail.write||""==e.form.write},on:{click:e.clickSubmitUpdateWrite}},[a("v-icon",{attrs:{left:""}},[e._v("save")]),e._v("\n                        บันทึกข้อความ\n                    ")],1),e._v(" "),a("v-divider"),e._v(" "),a("v-form",{ref:"formInputImages"},[a("v-file-input",{staticClass:"mb-4",attrs:{multiple:"",outlined:"","prepend-icon":"image",placeholder:"เลือกรูปที่นี่",accept:"image/*","hide-details":""},on:{change:e.onFileChangeImages}})],1),e._v(" "),e.response.data.images.length>1?a("div",[e.response.data.images.length>1&&!e.chooseRemove?a("div",[a("v-btn",{staticClass:"mb-2",attrs:{color:"warning"},on:{click:function(t){e.chooseRemove=!0}}},[a("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("\n                                เลือกรูปที่ต้องการลบ")],1)],1):a("div",[a("v-btn",{staticClass:"mb-2",attrs:{color:"error",disabled:0==e.chooseRemoveImages.length},on:{click:function(t){return e.clickRemoveImage(e.chooseRemoveImages)}}},[a("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("\n                                ลบรูปที่เลือกไว้")],1),e._v(" "),a("v-btn",{staticClass:"mb-2",attrs:{color:"error"},on:{click:function(t){return e.clickRemoveImage(e.response.data.images)}}},[a("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("\n                                ลบรูปทั้งหมด")],1),e._v(" "),a("v-btn",{staticClass:"mb-2",attrs:{color:"warning"},on:{click:e.clickRemoveImageCancel}},[a("v-icon",{attrs:{left:""}},[e._v("close")]),e._v("\n                                ยกเลิก")],1)],1)]):e._e(),e._v(" "),0==e.response.data.images.length?a("v-alert",{attrs:{type:"info"}},[e._v("โปรดอัปโหลดรูป")]):e._e(),e._v(" "),e._l(e.response.data.images,(function(t){return a("v-card",{key:t.id,staticClass:"mb-2",attrs:{outlined:""}},[a("v-img",{attrs:{src:t.url,"lazy-src":t.url},scopedSlots:e._u([{key:"placeholder",fn:function(){return[a("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)}),e._v(" "),a("v-card-text",{staticClass:"pa-2"},[e.chooseRemove?a("v-checkbox",{staticClass:"ma-0",attrs:{label:"ลบรูปนี้","hide-details":"",value:t},model:{value:e.chooseRemoveImages,callback:function(t){e.chooseRemoveImages=t},expression:"chooseRemoveImages"}}):a("div",{staticClass:"mt-2"},[t.main?a("v-btn",{attrs:{color:"warning",text:""},on:{click:function(a){return e.clickImageMain(t.id)}}},[a("v-icon",{attrs:{left:""}},[e._v("bookmark_border")]),e._v("\n                                    ยกเลิกรูปหลัก\n                                ")],1):a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){return e.clickImageMain(t.id)}}},[a("v-icon",{attrs:{left:""}},[e._v("bookmark")]),e._v("\n                                    ตั้งเป็นรูปหลัก\n                                ")],1),e._v(" "),a("v-btn",{attrs:{color:"error",text:""},on:{click:function(a){return e.clickRemoveImage([t])}}},[a("v-icon",{attrs:{left:""}},[e._v("delete")]),e._v("\n                                    ลบรูปนี้\n                                ")],1)],1)],1)],1)}))],2):a("v-card-text",[a("v-alert",{attrs:{type:"warning"}},[e._v("คุณไม่มีสิทธิ์อัปโหลดส่วนนี้")])],1)],1)],1)],1):a("v-alert",{attrs:{type:"error"}},[e._v("\n        "+e._s(e.response.message)+"\n    ")])],1)}),[],!1,null,null,null);t.default=l.exports}}]);