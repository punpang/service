(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{10:function(t,e,r){"use strict";r.r(e);var a=r(0),n=r.n(a);function o(t,e,r,a,n,o,s){try{var c=t[o](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(a,n)}var s={props:["search"],data:function(){return{loadingSubmit:!1,dialogAddCustomer:!1,form:{name:"",phone:""},snackbar:{}}},methods:{start:function(){this.form.phone=this.search},submit:function(){var t,e=this;return(t=n.a.mark((function t(){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.addCustomerForm.validate()){t.next=8;break}return e.loadingSubmit=!0,t.next=4,e.$store.dispatch("customer/add",e.form);case 4:200===(r=t.sent).status?(e.snackbar={color:"success",text:"สำเร็จ",on:!0},e.dialogAddCustomer=!1,e.loadingSubmit=!1,e.$refs.addCustomerForm.reset()):422===r.status?(e.form.phone="",e.snackbar={color:"warning",text:r.data.errors.phone[0],on:!0},e.loadingSubmit=!1):e.snackbar={color:"warning",text:"เกิดข้อผิดพลาดบางอย่างขึ้น กรุณาลองอีกครั้ง",on:!0},t.next=9;break;case 8:e.snackbar={color:"warning",text:"โปรดกรอกข้อมูลให้ถูกต้อง",on:!0};case 9:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function c(t){o(s,a,n,c,i,"next",t)}function i(t){o(s,a,n,c,i,"throw",t)}c(void 0)}))})()},reset:function(){this.$refs.addCustomerForm.reset(),this.snackbar={color:"error",text:"ล้างสำเร็จ",on:!0}}}},c=r(1),i=Object(c.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",[r("v-col",[r("h3",[t._v("รายชื่อลูกค้า")]),t._v(" "),r("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[r("v-btn",t._g({attrs:{color:"info"},on:{click:t.start}},a),[r("v-icon",{attrs:{left:""}},[t._v("add")]),t._v("\n                    เพิ่มลูกค้ารายใหม่\n                ")],1)]}}]),model:{value:t.dialogAddCustomer,callback:function(e){t.dialogAddCustomer=e},expression:"dialogAddCustomer"}},[t._v(" "),r("v-card",[r("v-card-title",[r("h3",[t._v("เพิ่มลูกค้ารายใหม่")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogAddCustomer=!1}}},[r("v-icon",{attrs:{color:"error"}},[t._v("close")])],1)],1),t._v(" "),r("v-card-text",[r("v-form",{ref:"addCustomerForm",attrs:{"lazy-validation":""}},[r("v-text-field",{attrs:{label:"ชื่อลูกค้า",rules:[function(t){return!!t||"ห้ามเว้นว่าง"}],"append-icon":"person"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),r("v-text-field",{attrs:{label:"เบอร์โทร",counter:10,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 10==t.length||"กรอกเบอร์โทร 10 หลักเท่านั้น"},function(t){return/[0]{1}[0-9]{9}/.test(t)||"กรุณาขึ้นต้นด้วยเลข 0 และกรอกเบอร์โทร 10 หลักเท่านั้น"}],"append-icon":"phone"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1),t._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"success",loading:t.loadingSubmit},on:{click:t.submit}},[r("v-icon",{attrs:{left:""}},[t._v("save")]),t._v("เพิ่มลูกค้าใหม่")],1),t._v(" "),r("v-btn",{attrs:{color:"error"},on:{click:t.reset}},[r("v-icon",{attrs:{left:""}},[t._v("refresh")]),t._v("ล้างข้อมูล")],1)],1)],1)],1)],1),t._v(" "),r("v-spacer"),t._v(" "),r("v-snackbar",{attrs:{right:"",color:t.snackbar.color},model:{value:t.snackbar.on,callback:function(e){t.$set(t.snackbar,"on",e)},expression:"snackbar.on"}},[t._v(t._s(t.snackbar.text))])],1)}),[],!1,null,null,null).exports;function l(t,e,r,a,n,o,s){try{var c=t[o](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(a,n)}var u={props:["data"],data:function(){return{dialogEdit:!1,loadSave:!1,form:{id:this.data.id,name:this.data.name,phone:this.data.phone},snackbar:{status:!1,color:"",text:""}}},methods:{save:function(){var t,e=this;return(t=n.a.mark((function t(){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.editForm.validate()){t.next=6;break}return e.loadSave=!0,t.next=4,e.$store.dispatch("customer/edit",e.form);case 4:200===(r=t.sent).status?(e.loadSave=!1,e.dialogEdit=!1,e.snackbar={color:"success",text:"แก้ไขข้อมูลสำเร็จ",status:!0}):422===r.status?(e.form.phone="",e.snackbar={color:"warning",text:r.data.errors.phone[0],status:!0},e.loadSave=!1):e.snackbar={color:"warning",text:"เกิดข้อผิดพลาดบางอย่างขึ้น กรุณาลองอีกครั้ง",on:!0};case 6:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(a,n){var o=t.apply(e,r);function s(t){l(o,a,n,s,c,"next",t)}function c(t){l(o,a,n,s,c,"throw",t)}s(void 0)}))})()},savea:function(){var t=this;this.$refs.editForm.validate()&&(this.loadSave=!0,axios.post("/api/customer/"+this.data.id+"/edit",{name:this.form.name,phone:this.form.phone},{headers:{Authorization:this.$store.getters["main/AuthToken"]}}).then((function(e){t.$store.commit("customer/getCustomers",e.data),t.loadSave=!1,t.dialogEdit=!1,t.snackbar={color:"success",text:"แก้ไขข้อมูลสำเร็จ",status:!0}})).catch((function(e){422==e.response.status?t.snackbar={status:!0,color:"error",text:e.response.data.errors.phone[0]}:t.snackbar={status:!0,color:"warning",text:"กรุณาลองอีกครั้งภายหลัง"},t.loadSave=!1})))}}},v={props:["data"],data:function(){return{dialogDelete:!1,confirm:"",form:{name:this.data.name,phone:this.data.phone},snackbar:{status:!1,color:"",text:""}}},methods:{submitDelete:function(){this.$refs.deleteForm.validate()&&("ลบข้อมูล"==this.confirm?(this.snackbar={status:!0,color:"success",text:"ลบข้อมูลเรียบร้อย"},this.$refs.deleteForm.reset()):this.snackbar={status:!0,color:"error",text:"กรุณากรอกคำว่า 'ลบข้อมูล' ลงในช่องว่าง"})}}};function d(t,e,r,a,n,o,s){try{var c=t[o](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(a,n)}var f={props:["selectCustomerInGet"],components:{editCustomer:Object(c.a)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[r("v-btn",t._g({attrs:{color:"warning",fab:"","x-small":""}},a),[r("v-icon",[t._v("edit")])],1)]}}]),model:{value:t.dialogEdit,callback:function(e){t.dialogEdit=e},expression:"dialogEdit"}},[t._v(" "),r("v-form",{ref:"editForm",attrs:{"lazy-validation":""}},[r("v-card",[r("v-card-title",[r("h3",[t._v("แก้ไขข้อมูล")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogEdit=!1}}},[r("v-icon",{attrs:{color:"error"}},[t._v("close")])],1)],1),t._v(" "),r("v-card-text",[r("v-text-field",{attrs:{label:"ชื่อลูกค้า",rules:[function(t){return!!t||"ห้ามเว้นว่าง"}],"append-icon":"person"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),r("v-text-field",{attrs:{label:"เบอร์โทร",counter:10,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 10==t.length||"กรอกเบอร์โทร 10 หลักเท่านั้น"},function(t){return/[0]{1}[0-9]{9}/.test(t)||"กรุณาขึ้นต้นด้วยเลข 0 และกรอกเบอร์โทร 10 หลักเท่านั้น"}],"append-icon":"phone"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"success",loading:t.loadSave},on:{click:t.save}},[r("v-icon",{attrs:{left:""}},[t._v("edit")]),t._v("\n                        บันทึกข้อมูล\n                    ")],1),t._v(" "),r("v-btn",{attrs:{color:"error"},on:{click:function(e){t.dialogEdit=!1}}},[r("v-icon",{attrs:{left:""}},[t._v("close")]),t._v("\n                        ยกเลิก\n                    ")],1)],1)],1)],1)],1),t._v(" "),r("v-snackbar",{attrs:{color:t.snackbar.color,right:""},model:{value:t.snackbar.status,callback:function(e){t.$set(t.snackbar,"status",e)},expression:"snackbar.status"}},[t._v(t._s(t.snackbar.text))])],1)}),[],!1,null,null,null).exports,deleteCustomer:Object(c.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[r("v-btn",t._g({attrs:{color:"error",fab:"","x-small":""}},a),[r("v-icon",[t._v("delete")])],1)]}}]),model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}},[t._v(" "),r("v-card",[r("v-card-title",[r("h3",[t._v("ลบข้อมูล")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){t.dialogDelete=!1}}},[r("v-icon",[t._v("close")])],1)],1),t._v(" "),r("v-card-text",[r("v-text-field",{attrs:{readonly:"",label:"ชื่อลูกค้า"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),r("v-text-field",{attrs:{readonly:"",label:"เบอร์โทร"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}}),t._v(" "),r("v-alert",{attrs:{type:"warning"}},[t._v("ต้องการลบข้อมูลนี้หรือไม่")]),t._v("\n                กรุณากรอกคำว่า "),r("b",[t._v('"ลบข้อมูล"')]),t._v(" ลงในช่องว่าง\n                "),r("v-form",{ref:"deleteForm",attrs:{"lazy-validation":""}},[r("v-text-field",{attrs:{autofocus:"",counter:8,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 8==t.length}]},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}})],1)],1),t._v(" "),r("v-card-actions",[r("v-btn",{attrs:{color:"warning"},on:{click:t.submitDelete}},[r("v-icon",{attrs:{left:""}},[t._v("delete")]),t._v("\n                    ลบข้อมูล\n                ")],1),t._v(" "),r("v-btn",{attrs:{color:"error"},on:{click:function(e){t.dialogDelete=!1}}},[r("v-icon",{attrs:{left:""}},[t._v("close")]),t._v("\n                    ปิด\n                ")],1)],1)],1)],1),t._v(" "),r("v-snackbar",{attrs:{color:t.snackbar.color,right:""},model:{value:t.snackbar.status,callback:function(e){t.$set(t.snackbar,"status",e)},expression:"snackbar.status"}},[t._v(t._s(t.snackbar.text))])],1)}),[],!1,null,null,null).exports},data:function(){return{loadingTable:!0,search:"",headerTable:[{text:"ชื่อลูกค้า",value:"name"},{text:"เบอร์โทร",value:"phone"},{text:"การจัดการ",value:"action"}],snackbar:{status:!0,color:"info",text:"กำลังโหลดข้อมูล..."}}},methods:{remove:function(){confirm("คุณต้องการลบใช่หรือไม่")},clickSelectCustomer:function(t){this.$emit("onCustomer",t)},changeSearch:function(t){this.$emit("onSearch",t)}},beforeCreate:function(){var t,e=this;return(t=n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("customer/get");case 2:200===t.sent.status?(e.loadingTable=!1,e.snackbar={status:!0,color:"success",text:"โหลดข้อมูลลูกค้าสำเร็จ"}):(e.snackbar={status:!0,color:"warning",text:"เกิดข้อผิดพลาดบางอย่าง กรุณาลองอีกครั้ง"},e.loadingTable=!1);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(a,n){var o=t.apply(e,r);function s(t){d(o,a,n,s,c,"next",t)}function c(t){d(o,a,n,s,c,"throw",t)}s(void 0)}))})()}},m={props:["selectCustomer"],components:{addCustomer:i,getCustomer:Object(c.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-text-field",{attrs:{label:"ค้นหาลูกค้าจากหมายเลขโทรศัพท์","append-icon":"search",type:"number",pattern:"/d*"},on:{change:function(e){return t.changeSearch(t.search)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),r("v-data-table",{attrs:{headers:t.headerTable,items:this.$store.getters["customer/getCustomers"],loading:t.loadingTable,search:t.search,"no-results-text":"ไม่พบข้อมูลที่ค้นหา","loading-text":"รอสักครู่...กำลังโหลดข้อมูล","item-key":"id"},scopedSlots:t._u([{key:"item.action",fn:function(e){var a=e.item;return[r("v-container",[r("v-row",[r("editCustomer",{staticClass:"mr-2",attrs:{data:a}}),t._v(" "),r("deleteCustomer",{staticClass:"mr-2",attrs:{data:a}}),t._v(" "),1==t.selectCustomerInGet?r("v-btn",{attrs:{fab:"","x-small":"",color:"info"},on:{click:function(e){return t.clickSelectCustomer(a)}}},[r("v-icon",[t._v("get_app")])],1):t._e()],1)],1)]}}])}),t._v(" "),r("v-snackbar",{attrs:{right:"",color:t.snackbar.color},model:{value:t.snackbar.status,callback:function(e){t.$set(t.snackbar,"status",e)},expression:"snackbar.status"}},[t._v(t._s(t.snackbar.text))])],1)}),[],!1,null,null,null).exports},data:function(){return{search:""}},methods:{onCustomer:function(t){this.$emit("onCustomer",t)},onSearch:function(t){this.search=t}}},h=Object(c.a)(m,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("addCustomer",{attrs:{search:this.search}}),this._v(" "),e("getCustomer",{attrs:{selectCustomerInGet:this.selectCustomer},on:{onCustomer:this.onCustomer,onSearch:this.onSearch}})],1)}),[],!1,null,null,null);e.default=h.exports}}]);