(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{12:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r);function a(t,e,n,r,o,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,o)}var s={props:["search"],data:function(){return{loadingSubmit:!1,dialogAddCustomer:!1,form:{name:"",phone:""}}},methods:{start:function(){this.form.phone=this.search},submit:function(){var t,e=this;return(t=o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.addCustomerForm.validate()){t.next=8;break}return e.loadingSubmit=!0,t.next=4,e.$store.dispatch("customer/add",e.form);case 4:200===(n=t.sent).status?(e.$toast.success("สำเร็จ"),e.dialogAddCustomer=!1,e.loadingSubmit=!1,e.$refs.addCustomerForm.reset()):422===n.status?(e.form.phone="",e.$toast.warning(n.data.errors.phone[0]),e.loadingSubmit=!1):e.$toast.warning("เกิดข้อผิดพลาดบางอย่างขึ้น กรุณาลองอีกครั้ง"),t.next=9;break;case 8:e.$toast.warning("โปรดกรอกข้อมูลให้ถูกต้อง");case 9:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var s=t.apply(e,n);function i(t){a(s,r,o,i,c,"next",t)}function c(t){a(s,r,o,i,c,"throw",t)}i(void 0)}))})()},reset:function(){this.$refs.addCustomerForm.reset(),this.$toast.error("ล้างสำเร็จ")}}},i=n(1),c=Object(i.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",[n("v-col",[n("h3",[t._v("รายชื่อลูกค้า")]),t._v(" "),n("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({attrs:{color:"info"},on:{click:t.start}},r),[n("v-icon",{attrs:{left:""}},[t._v("add")]),t._v("\n                    เพิ่มลูกค้ารายใหม่\n                ")],1)]}}]),model:{value:t.dialogAddCustomer,callback:function(e){t.dialogAddCustomer=e},expression:"dialogAddCustomer"}},[t._v(" "),n("v-card",[n("v-card-title",[n("h3",[t._v("เพิ่มลูกค้ารายใหม่")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogAddCustomer=!1}}},[n("v-icon",{attrs:{color:"error"}},[t._v("close")])],1)],1),t._v(" "),n("v-card-text",[n("v-form",{ref:"addCustomerForm",attrs:{"lazy-validation":""}},[n("v-text-field",{attrs:{label:"ชื่อลูกค้า",rules:[function(t){return!!t||"ห้ามเว้นว่าง"}],"append-icon":"person"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),n("v-text-field",{attrs:{label:"เบอร์โทร",counter:10,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 10==t.length||"กรอกเบอร์โทร 10 หลักเท่านั้น"},function(t){return/[0]{1}[0-9]{9}/.test(t)||"กรุณาขึ้นต้นด้วยเลข 0 และกรอกเบอร์โทร 10 หลักเท่านั้น"}],"append-icon":"phone"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"success",loading:t.loadingSubmit},on:{click:t.submit}},[n("v-icon",{attrs:{left:""}},[t._v("save")]),t._v("เพิ่มลูกค้าใหม่")],1),t._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:t.reset}},[n("v-icon",{attrs:{left:""}},[t._v("refresh")]),t._v("ล้างข้อมูล")],1)],1)],1)],1)],1),t._v(" "),n("v-spacer")],1)}),[],!1,null,null,null).exports;function l(t,e,n,r,o,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,o)}var u={props:["data"],data:function(){return{dialogEdit:!1,loadSave:!1,form:{id:this.data.id,name:this.data.name,phone:this.data.phone}}},methods:{save:function(){var t,e=this;return(t=o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.editForm.validate()){t.next=6;break}return e.loadSave=!0,t.next=4,e.$store.dispatch("customer/edit",e.form);case 4:200===(n=t.sent).status?(e.loadSave=!1,e.dialogEdit=!1,e.$toast.success("แก้ไขข้อมูลสำเร็จ")):422===n.status?(e.form.phone="",e.$toast.warning(n.data.errors.phone[0]),e.loadSave=!1):e.$toast.warning("เกิดข้อผิดพลาดบางอย่างขึ้น กรุณาลองอีกครั้ง");case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(t){l(a,r,o,s,i,"next",t)}function i(t){l(a,r,o,s,i,"throw",t)}s(void 0)}))})()},savea:function(){var t=this;this.$refs.editForm.validate()&&(this.loadSave=!0,axios.post("/api/customer/"+this.data.id+"/edit",{name:this.form.name,phone:this.form.phone},{headers:{Authorization:this.$store.getters["main/AuthToken"]}}).then((function(e){t.$store.commit("customer/getCustomers",e.data),t.loadSave=!1,t.dialogEdit=!1,t.$toast.success("แก้ไขข้อมูลสำเร็จ")})).catch((function(e){422==e.response.status?t.$toast.error(e.response.data.errors.phone[0]):t.$toast.warning("กรุณาลองอีกครั้งภายหลัง"),t.loadSave=!1})))}}},d={props:["data"],data:function(){return{dialogDelete:!1,confirm:"",form:{name:this.data.name,phone:this.data.phone}}},methods:{submitDelete:function(){this.$refs.deleteForm.validate()&&("ลบข้อมูล"==this.confirm?(this.$toast.success("ลบข้อมูลเรียบร้อย"),this.$refs.deleteForm.reset()):this.$toast.error("กรุณากรอกคำว่า 'ลบข้อมูล' ลงในช่องว่าง"))}}};function v(t,e,n,r,o,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,o)}var f={props:["selectCustomerInGet"],components:{editCustomer:Object(i.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({attrs:{color:"warning",fab:"","x-small":""}},r),[n("v-icon",[t._v("edit")])],1)]}}]),model:{value:t.dialogEdit,callback:function(e){t.dialogEdit=e},expression:"dialogEdit"}},[t._v(" "),n("v-form",{ref:"editForm",attrs:{"lazy-validation":""}},[n("v-card",[n("v-card-title",[n("h3",[t._v("แก้ไขข้อมูล")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogEdit=!1}}},[n("v-icon",{attrs:{color:"error"}},[t._v("close")])],1)],1),t._v(" "),n("v-card-text",[n("v-text-field",{attrs:{label:"ชื่อลูกค้า",rules:[function(t){return!!t||"ห้ามเว้นว่าง"}],"append-icon":"person"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),n("v-text-field",{attrs:{label:"เบอร์โทร",counter:10,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 10==t.length||"กรอกเบอร์โทร 10 หลักเท่านั้น"},function(t){return/[0]{1}[0-9]{9}/.test(t)||"กรุณาขึ้นต้นด้วยเลข 0 และกรอกเบอร์โทร 10 หลักเท่านั้น"}],"append-icon":"phone"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"success",loading:t.loadSave},on:{click:t.save}},[n("v-icon",{attrs:{left:""}},[t._v("edit")]),t._v("\n                        บันทึกข้อมูล\n                    ")],1),t._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:function(e){t.dialogEdit=!1}}},[n("v-icon",{attrs:{left:""}},[t._v("close")]),t._v("\n                        ยกเลิก\n                    ")],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports,deleteCustomer:Object(i.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[n("v-btn",t._g({attrs:{color:"error",fab:"","x-small":""}},r),[n("v-icon",[t._v("delete")])],1)]}}]),model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}},[t._v(" "),n("v-card",[n("v-card-title",[n("h3",[t._v("ลบข้อมูล")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:"",color:"error"},on:{click:function(e){t.dialogDelete=!1}}},[n("v-icon",[t._v("close")])],1)],1),t._v(" "),n("v-card-text",[n("v-text-field",{attrs:{readonly:"",label:"ชื่อลูกค้า"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),n("v-text-field",{attrs:{readonly:"",label:"เบอร์โทร"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}}),t._v(" "),n("v-alert",{attrs:{type:"warning"}},[t._v("ต้องการลบข้อมูลนี้หรือไม่")]),t._v("\n                กรุณากรอกคำว่า "),n("b",[t._v('"ลบข้อมูล"')]),t._v(" ลงในช่องว่าง\n                "),n("v-form",{ref:"deleteForm",attrs:{"lazy-validation":""}},[n("v-text-field",{attrs:{autofocus:"",counter:8,rules:[function(t){return!!t||"ห้ามเว้นว่าง"},function(t){return 8==t.length}]},model:{value:t.confirm,callback:function(e){t.confirm=e},expression:"confirm"}})],1)],1),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"warning"},on:{click:t.submitDelete}},[n("v-icon",{attrs:{left:""}},[t._v("delete")]),t._v("\n                    ลบข้อมูล\n                ")],1),t._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:function(e){t.dialogDelete=!1}}},[n("v-icon",{attrs:{left:""}},[t._v("close")]),t._v("\n                    ปิด\n                ")],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{loadingTable:!0,search:"",headerTable:[{text:"ชื่อลูกค้า",value:"name"},{text:"เบอร์โทร",value:"phone"},{text:"การจัดการ",value:"action"}]}},methods:{remove:function(){confirm("คุณต้องการลบใช่หรือไม่")},clickSelectCustomer:function(t){this.$emit("onCustomer",t)},changeSearch:function(t){this.$emit("onSearch",t)}},beforeCreate:function(){var t,e=this;return(t=o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("customer/get");case 2:200===t.sent.status?(e.loadingTable=!1,e.$toast.success("โหลดข้อมูลลูกค้าสำเร็จ")):(e.$toast.warning("เกิดข้อผิดพลาดบางอย่าง กรุณาลองอีกครั้ง"),e.loadingTable=!1);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(t){v(a,r,o,s,i,"next",t)}function i(t){v(a,r,o,s,i,"throw",t)}s(void 0)}))})()}},m={props:["selectCustomer"],components:{addCustomer:c,getCustomer:Object(i.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text-field",{attrs:{label:"ค้นหาลูกค้าจากหมายเลขโทรศัพท์","append-icon":"search",type:"number",pattern:"/d*"},on:{change:function(e){return t.changeSearch(t.search)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),n("v-data-table",{attrs:{headers:t.headerTable,items:this.$store.getters["customer/getCustomers"],loading:t.loadingTable,search:t.search,"no-results-text":"ไม่พบข้อมูลที่ค้นหา","loading-text":"รอสักครู่...กำลังโหลดข้อมูล","item-key":"id"},scopedSlots:t._u([{key:"item.action",fn:function(e){var r=e.item;return[n("v-container",[n("v-row",[n("editCustomer",{staticClass:"mr-2",attrs:{data:r}}),t._v(" "),n("deleteCustomer",{staticClass:"mr-2",attrs:{data:r}}),t._v(" "),1==t.selectCustomerInGet?n("v-btn",{attrs:{fab:"","x-small":"",color:"info"},on:{click:function(e){return t.clickSelectCustomer(r)}}},[n("v-icon",[t._v("get_app")])],1):t._e()],1)],1)]}}])})],1)}),[],!1,null,null,null).exports},data:function(){return{search:""}},methods:{onCustomer:function(t){this.$emit("onCustomer",t)},onSearch:function(t){this.search=t}}},h=Object(i.a)(m,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("addCustomer",{attrs:{search:this.search}}),this._v(" "),e("getCustomer",{attrs:{selectCustomerInGet:this.selectCustomer},on:{onCustomer:this.onCustomer,onSearch:this.onSearch}})],1)}),[],!1,null,null,null);e.default=h.exports}}]);